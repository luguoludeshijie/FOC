/*******************************************************************************
*
* 文件名称: Srv_Can.h
* 版 本 号: V1.0 
* 作    者: linbo.liu
* 生成日期: 2024年10月27日
* 功能描述: CAN服务层
*
*******************************************************************************/
#ifndef _SRV_CANIF_H_
#define _SRV_CANIF_H_

/*******************************************************************************
 *-----------------------------------头文件-------------------------------------
 ******************************************************************************/
#include "Com_DBC_Cfg.h"
#include "Srv.h"

/*******************************************************************************
 *-----------------------------------宏定义-------------------------------------
 ******************************************************************************/
#define MOTOR_STATE_TXCANID                    0x180
#define BUTTON_STATE_TXCANID                   0x181

#define MOTOR_ID_PI_CTRL_RXCANID               0x200
#define MOTOR_IQ_PI_CTRL_RXCANID               0x201

#define XCP_ID_TXCANID                         0x7D5
#define XCP_ID_RXCANID                         0x7D0             
/*******************************************************************************
 *---------------------------------数据类型定义----------------------------------
 ******************************************************************************/
typedef void (*Srv_CanTxFrameCallbackPtr)(void);

typedef struct {
    uint8_t ucFrameIndex;  //帧索引
    uint8_t ucSendTime;    //发送间隔
    uint8_t ucSendCnt;     //发送计数
    uint8_t ucSendWait;    //CAN发送等待
    uint8_t ucSendFlag;    //运行标志
    Srv_CanTxFrameCallbackPtr Srv_CanTxFrameCallback; //任务回调函数
} Srv_CanTxFrame_T;

typedef enum {
    CAN_BUTTON_FRAME,
    CAN_MOTOR_FRAME,
    CAN_MAX_FRAME,
} Srv_CanFrame_E;   //CAN数据帧

/*******************************************************************************
 *-----------------------------------常量定义------------------------------------
 ******************************************************************************/


/*******************************************************************************
 *-----------------------——--------全局变量定义----------------------------------
 ******************************************************************************/


/*******************************************************************************
 *-----------------------------------函数接口------------------------------------
 ******************************************************************************/
extern void Srv_CanInit(void);
void DBC_InfoFill(Srv_CanFrame_E arg_CanFrame,Srv_CanTxFrameCallbackPtr arg_Cb);
extern void Srv_CanMain(void);


/*******************************************************************************
 *---------------------------—----—--变量接口------------------------------------
 ******************************************************************************/
extern CanTxMessage g_xCanTxData;

#endif
/*******************************************************************************
 *---------------------------—----—---结束--------------------------------------
 ******************************************************************************/