/*******************************************************************************
*
* 文件名称: Motor_Math.c
* 版 本 号: V1.0 
* 作    者: linbo.liu
* 生成日期: 2024年x月x日
* 功能描述: 
*
*******************************************************************************/
/*******************************************************************************
 *----------------------------------头文件--------------------------------------
 ******************************************************************************/
#include "Srv.h"

/*******************************************************************************
 *----------------------------------宏定义---------------------------------------
 ******************************************************************************/
#define U_0 0x0c00 //  0---4095的电角度控制分四段查询90
#define U0_90 0x0000
#define U90_180 0x0400
#define U180_270 0x0800
#define U270_360 0x0c00

/*******************************************************************************
 *--------------------------------数据类型定义-----------------------------------
 ******************************************************************************/


/*******************************************************************************
 *----------------------------------函数声明-------------------------------------
 ******************************************************************************/


/*******************************************************************************
 *-----------------------------------常量定义------------------------------------
 ******************************************************************************/


/*******************************************************************************
 *-----------------------——--------全局变量定义----------------------------------
 ******************************************************************************/
Ang_SinCos Ang_SinCosPark = Ang_SinCos_DEFAULTS;

const float fSin[1025] =
{
    0,           // sin(2*pi/4096*0)
    0.00153398,  // sin(2*pi/4096*1)
    0.003067957, // sin(2*pi/4096*2)
    0.004601926,
    0.006135885,
    0.007669829,
    0.009203755,
    0.010737659,
    0.012271538,
    0.013805389,
    0.015339206,
    0.016872988,
    0.01840673,
    0.019940429,
    0.02147408,
    0.023007681,
    0.024541229,
    0.026074718,
    0.027608146,
    0.029141509,
    0.030674803,
    0.032208025,
    0.033741172,
    0.035274239,
    0.036807223,
    0.03834012,
    0.039872928,
    0.041405641,
    0.042938257,
    0.044470772,
    0.046003182,
    0.047535484,
    0.049067674,
    0.050599749,
    0.052131705,
    0.053663538,
    0.055195244,
    0.056726821,
    0.058258265,
    0.059789571,
    0.061320736,
    0.062851758,
    0.064382631,
    0.065913353,
    0.06744392,
    0.068974328,
    0.070504573,
    0.072034653,
    0.073564564,
    0.075094301,
    0.076623861,
    0.078153242,
    0.079682438,
    0.081211447,
    0.082740265,
    0.084268888,
    0.085797312,
    0.087325535,
    0.088853553,
    0.090381361,
    0.091908956,
    0.093436336,
    0.094963495,
    0.096490431,
    0.09801714,
    0.099543619,
    0.101069863,
    0.102595869,
    0.104121634,
    0.105647154,
    0.107172425,
    0.108697444,
    0.110222207,
    0.111746711,
    0.113270952,
    0.114794927,
    0.116318631,
    0.117842062,
    0.119365215,
    0.120888087,
    0.122410675,
    0.123932975,
    0.125454983,
    0.126976696,
    0.128498111,
    0.130019223,
    0.131540029,
    0.133060525,
    0.134580709,
    0.136100575,
    0.137620122,
    0.139139344,
    0.140658239,
    0.142176804,
    0.143695033,
    0.145212925,
    0.146730474,
    0.148247679,
    0.149764535,
    0.151281038,
    0.152797185,
    0.154312973,
    0.155828398,
    0.157343456,
    0.158858143,
    0.160372457,
    0.161886394,
    0.163399949,
    0.16491312,
    0.166425904,
    0.167938295,
    0.169450291,
    0.170961889,
    0.172473084,
    0.173983873,
    0.175494253,
    0.17700422,
    0.178513771,
    0.180022901,
    0.181531608,
    0.183039888,
    0.184547737,
    0.186055152,
    0.187562129,
    0.189068664,
    0.190574755,
    0.192080397,
    0.193585587,
    0.195090322,
    0.196594598,
    0.198098411,
    0.199601758,
    0.201104635,
    0.202607039,
    0.204108966,
    0.205610413,
    0.207111376,
    0.208611852,
    0.210111837,
    0.211611327,
    0.21311032,
    0.214608811,
    0.216106797,
    0.217604275,
    0.21910124,
    0.22059769,
    0.222093621,
    0.223589029,
    0.225083911,
    0.226578264,
    0.228072083,
    0.229565366,
    0.231058108,
    0.232550307,
    0.234041959,
    0.235533059,
    0.237023606,
    0.238513595,
    0.240003022,
    0.241491885,
    0.24298018,
    0.244467903,
    0.24595505,
    0.247441619,
    0.248927606,
    0.250413007,
    0.251897818,
    0.253382037,
    0.25486566,
    0.256348682,
    0.257831102,
    0.259312915,
    0.260794118,
    0.262274707,
    0.263754679,
    0.26523403,
    0.266712757,
    0.268190857,
    0.269668326,
    0.27114516,
    0.272621355,
    0.27409691,
    0.275571819,
    0.27704608,
    0.278519689,
    0.279992643,
    0.281464938,
    0.28293657,
    0.284407537,
    0.285877835,
    0.28734746,
    0.288816408,
    0.290284677,
    0.291752263,
    0.293219163,
    0.294685372,
    0.296150888,
    0.297615707,
    0.299079826,
    0.300543241,
    0.302005949,
    0.303467947,
    0.30492923,
    0.306389795,
    0.30784964,
    0.30930876,
    0.310767153,
    0.312224814,
    0.31368174,
    0.315137929,
    0.316593376,
    0.318048077,
    0.319502031,
    0.320955232,
    0.322407679,
    0.323859367,
    0.325310292,
    0.326760452,
    0.328209844,
    0.329658463,
    0.331106306,
    0.33255337,
    0.333999651,
    0.335445147,
    0.336889853,
    0.338333767,
    0.339776884,
    0.341219202,
    0.342660717,
    0.344101426,
    0.345541325,
    0.346980411,
    0.34841868,
    0.34985613,
    0.351292756,
    0.352728556,
    0.354163525,
    0.355597662,
    0.357030961,
    0.358463421,
    0.359895037,
    0.361325806,
    0.362755724,
    0.36418479,
    0.365612998,
    0.367040346,
    0.36846683,
    0.369892447,
    0.371317194,
    0.372741067,
    0.374164063,
    0.375586178,
    0.37700741,
    0.378427755,
    0.379847209,
    0.381265769,
    0.382683432,
    0.384100195,
    0.385516054,
    0.386931006,
    0.388345047,
    0.389758174,
    0.391170384,
    0.392581674,
    0.39399204,
    0.395401479,
    0.396809987,
    0.398217562,
    0.3996242,
    0.401029897,
    0.402434651,
    0.403838458,
    0.405241314,
    0.406643217,
    0.408044163,
    0.409444149,
    0.410843171,
    0.412241227,
    0.413638312,
    0.415034424,
    0.41642956,
    0.417823716,
    0.419216888,
    0.420609074,
    0.422000271,
    0.423390474,
    0.424779681,
    0.426167889,
    0.427555093,
    0.428941292,
    0.430326481,
    0.431710658,
    0.433093819,
    0.434475961,
    0.43585708,
    0.437237174,
    0.438616239,
    0.439994271,
    0.441371269,
    0.442747228,
    0.444122145,
    0.445496017,
    0.44686884,
    0.448240612,
    0.44961133,
    0.450980989,
    0.452349587,
    0.453717121,
    0.455083587,
    0.456448982,
    0.457813304,
    0.459176548,
    0.460538711,
    0.461899791,
    0.463259784,
    0.464618686,
    0.465976496,
    0.467333209,
    0.468688822,
    0.470043332,
    0.471396737,
    0.472749032,
    0.474100215,
    0.475450282,
    0.47679923,
    0.478147056,
    0.479493758,
    0.480839331,
    0.482183772,
    0.483527079,
    0.484869248,
    0.486210276,
    0.48755016,
    0.488888897,
    0.490226483,
    0.491562916,
    0.492898192,
    0.494232309,
    0.495565262,
    0.496897049,
    0.498227667,
    0.499557113,
    0.500885383,
    0.502212474,
    0.503538384,
    0.504863109,
    0.506186645,
    0.507508991,
    0.508830143,
    0.510150097,
    0.51146885,
    0.512786401,
    0.514102744,
    0.515417878,
    0.516731799,
    0.518044504,
    0.51935599,
    0.520666254,
    0.521975293,
    0.523283103,
    0.524589683,
    0.525895027,
    0.527199135,
    0.528502002,
    0.529803625,
    0.531104001,
    0.532403128,
    0.533701002,
    0.53499762,
    0.536292979,
    0.537587076,
    0.538879909,
    0.540171473,
    0.541461766,
    0.542750785,
    0.544038527,
    0.545324988,
    0.546610167,
    0.547894059,
    0.549176662,
    0.550457973,
    0.551737988,
    0.553016706,
    0.554294121,
    0.555570233,
    0.556845037,
    0.558118531,
    0.559390712,
    0.560661576,
    0.561931121,
    0.563199344,
    0.564466242,
    0.565731811,
    0.566996049,
    0.568258953,
    0.569520519,
    0.570780746,
    0.572039629,
    0.573297167,
    0.574553355,
    0.575808191,
    0.577061673,
    0.578313796,
    0.579564559,
    0.580813958,
    0.58206199,
    0.583308653,
    0.584553943,
    0.585797857,
    0.587040394,
    0.588281548,
    0.589521319,
    0.590759702,
    0.591996695,
    0.593232295,
    0.594466499,
    0.595699304,
    0.596930708,
    0.598160707,
    0.599389298,
    0.600616479,
    0.601842247,
    0.603066599,
    0.604289531,
    0.605511041,
    0.606731127,
    0.607949785,
    0.609167012,
    0.610382806,
    0.611597164,
    0.612810082,
    0.614021559,
    0.615231591,
    0.616440175,
    0.617647308,
    0.618852988,
    0.620057212,
    0.621259977,
    0.622461279,
    0.623661118,
    0.624859488,
    0.626056388,
    0.627251815,
    0.628445767,
    0.629638239,
    0.63082923,
    0.632018736,
    0.633206755,
    0.634393284,
    0.63557832,
    0.636761861,
    0.637943904,
    0.639124445,
    0.640303482,
    0.641481013,
    0.642657034,
    0.643831543,
    0.645004537,
    0.646176013,
    0.647345969,
    0.648514401,
    0.649681307,
    0.650846685,
    0.652010531,
    0.653172843,
    0.654333618,
    0.655492853,
    0.656650546,
    0.657806693,
    0.658961293,
    0.660114342,
    0.661265838,
    0.662415778,
    0.663564159,
    0.664710978,
    0.665856234,
    0.666999922,
    0.668142041,
    0.669282588,
    0.67042156,
    0.671558955,
    0.672694769,
    0.673829,
    0.674961646,
    0.676092704,
    0.67722217,
    0.678350043,
    0.67947632,
    0.680600998,
    0.681724074,
    0.682845546,
    0.683965412,
    0.685083668,
    0.686200312,
    0.687315341,
    0.688428753,
    0.689540545,
    0.690650714,
    0.691759258,
    0.692866175,
    0.693971461,
    0.695075114,
    0.696177131,
    0.697277511,
    0.698376249,
    0.699473345,
    0.700568794,
    0.701662595,
    0.702754744,
    0.703845241,
    0.70493408,
    0.706021261,
    0.707106781,
    0.708190637,
    0.709272826,
    0.710353347,
    0.711432196,
    0.712509371,
    0.713584869,
    0.714658688,
    0.715730825,
    0.716801279,
    0.717870045,
    0.718937122,
    0.720002508,
    0.721066199,
    0.722128194,
    0.723188489,
    0.724247083,
    0.725303972,
    0.726359155,
    0.727412629,
    0.72846439,
    0.729514438,
    0.730562769,
    0.731609381,
    0.732654272,
    0.733697438,
    0.734738878,
    0.735778589,
    0.736816569,
    0.737852815,
    0.738887324,
    0.739920095,
    0.740951125,
    0.741980412,
    0.743007952,
    0.744033744,
    0.745057785,
    0.746080074,
    0.747100606,
    0.74811938,
    0.749136395,
    0.750151646,
    0.751165132,
    0.75217685,
    0.753186799,
    0.754194975,
    0.755201377,
    0.756206001,
    0.757208847,
    0.75820991,
    0.759209189,
    0.760206682,
    0.761202385,
    0.762196298,
    0.763188417,
    0.764178741,
    0.765167266,
    0.76615399,
    0.767138912,
    0.768122029,
    0.769103338,
    0.770082837,
    0.771060524,
    0.772036397,
    0.773010453,
    0.773982691,
    0.774953107,
    0.775921699,
    0.776888466,
    0.777853404,
    0.778816512,
    0.779777788,
    0.780737229,
    0.781694832,
    0.782650596,
    0.783604519,
    0.784556597,
    0.78550683,
    0.786455214,
    0.787401747,
    0.788346428,
    0.789289253,
    0.790230221,
    0.79116933,
    0.792106577,
    0.79304196,
    0.793975478,
    0.794907126,
    0.795836905,
    0.79676481,
    0.797690841,
    0.798614995,
    0.799537269,
    0.800457662,
    0.801376172,
    0.802292796,
    0.803207531,
    0.804120377,
    0.805031331,
    0.805940391,
    0.806847554,
    0.807752818,
    0.808656182,
    0.809557642,
    0.810457198,
    0.811354847,
    0.812250587,
    0.813144415,
    0.81403633,
    0.814926329,
    0.815814411,
    0.816700573,
    0.817584813,
    0.81846713,
    0.81934752,
    0.820225983,
    0.821102515,
    0.821977115,
    0.822849781,
    0.823720511,
    0.824589303,
    0.825456154,
    0.826321063,
    0.827184027,
    0.828045045,
    0.828904115,
    0.829761234,
    0.8306164,
    0.831469612,
    0.832320868,
    0.833170165,
    0.834017501,
    0.834862875,
    0.835706284,
    0.836547727,
    0.837387202,
    0.838224706,
    0.839060237,
    0.839893794,
    0.840725375,
    0.841554977,
    0.8423826,
    0.84320824,
    0.844031895,
    0.844853565,
    0.845673247,
    0.846490939,
    0.847306639,
    0.848120345,
    0.848932055,
    0.849741768,
    0.850549481,
    0.851355193,
    0.852158902,
    0.852960605,
    0.853760301,
    0.854557988,
    0.855353665,
    0.856147328,
    0.856938977,
    0.85772861,
    0.858516224,
    0.859301818,
    0.86008539,
    0.860866939,
    0.861646461,
    0.862423956,
    0.863199422,
    0.863972856,
    0.864744258,
    0.865513624,
    0.866280954,
    0.867046246,
    0.867809497,
    0.868570706,
    0.869329871,
    0.870086991,
    0.870842063,
    0.871595087,
    0.872346059,
    0.873094978,
    0.873841843,
    0.874586652,
    0.875329403,
    0.876070094,
    0.876808724,
    0.87754529,
    0.878279792,
    0.879012226,
    0.879742593,
    0.880470889,
    0.881197113,
    0.881921264,
    0.88264334,
    0.883363339,
    0.884081259,
    0.884797098,
    0.885510856,
    0.88622253,
    0.886932119,
    0.88763962,
    0.888345033,
    0.889048356,
    0.889749586,
    0.890448723,
    0.891145765,
    0.891840709,
    0.892533555,
    0.893224301,
    0.893912945,
    0.894599486,
    0.895283921,
    0.89596625,
    0.89664647,
    0.897324581,
    0.89800058,
    0.898674466,
    0.899346237,
    0.900015892,
    0.900683429,
    0.901348847,
    0.902012144,
    0.902673318,
    0.903332368,
    0.903989293,
    0.904644091,
    0.905296759,
    0.905947298,
    0.906595705,
    0.907241978,
    0.907886116,
    0.908528119,
    0.909167983,
    0.909805708,
    0.910441292,
    0.911074734,
    0.911706032,
    0.912335185,
    0.91296219,
    0.913587048,
    0.914209756,
    0.914830312,
    0.915448716,
    0.916064966,
    0.91667906,
    0.917290997,
    0.917900776,
    0.918508394,
    0.919113852,
    0.919717146,
    0.920318277,
    0.920917242,
    0.921514039,
    0.922108669,
    0.922701128,
    0.923291417,
    0.923879533,
    0.924465474,
    0.925049241,
    0.925630831,
    0.926210242,
    0.926787474,
    0.927362526,
    0.927935395,
    0.92850608,
    0.929074581,
    0.929640896,
    0.930205023,
    0.930766961,
    0.931326709,
    0.931884266,
    0.932439629,
    0.932992799,
    0.933543773,
    0.93409255,
    0.93463913,
    0.93518351,
    0.935725689,
    0.936265667,
    0.936803442,
    0.937339012,
    0.937872376,
    0.938403534,
    0.938932484,
    0.939459224,
    0.939983753,
    0.940506071,
    0.941026175,
    0.941544065,
    0.94205974,
    0.942573198,
    0.943084437,
    0.943593458,
    0.944100258,
    0.944604837,
    0.945107193,
    0.945607325,
    0.946105232,
    0.946600913,
    0.947094366,
    0.947585591,
    0.948074586,
    0.94856135,
    0.949045882,
    0.949528181,
    0.950008245,
    0.950486074,
    0.950961666,
    0.951435021,
    0.951906137,
    0.952375013,
    0.952841648,
    0.95330604,
    0.95376819,
    0.954228095,
    0.954685755,
    0.955141168,
    0.955594334,
    0.956045251,
    0.956493919,
    0.956940336,
    0.957384501,
    0.957826413,
    0.958266071,
    0.958703475,
    0.959138622,
    0.959571513,
    0.960002146,
    0.960430519,
    0.960856633,
    0.961280486,
    0.961702077,
    0.962121404,
    0.962538468,
    0.962953267,
    0.9633658,
    0.963776066,
    0.964184064,
    0.964589793,
    0.964993253,
    0.965394442,
    0.965793359,
    0.966190003,
    0.966584374,
    0.966976471,
    0.967366292,
    0.967753837,
    0.968139105,
    0.968522094,
    0.968902805,
    0.969281235,
    0.969657385,
    0.970031253,
    0.970402839,
    0.970772141,
    0.971139158,
    0.971503891,
    0.971866337,
    0.972226497,
    0.972584369,
    0.972939952,
    0.973293246,
    0.97364425,
    0.973992962,
    0.974339383,
    0.974683511,
    0.975025345,
    0.975364885,
    0.97570213,
    0.976037079,
    0.976369731,
    0.976700086,
    0.977028143,
    0.9773539,
    0.977677358,
    0.977998515,
    0.978317371,
    0.978633924,
    0.978948175,
    0.979260123,
    0.979569766,
    0.979877104,
    0.980182136,
    0.980484862,
    0.98078528,
    0.981083391,
    0.981379193,
    0.981672686,
    0.981963869,
    0.982252741,
    0.982539302,
    0.982823551,
    0.983105487,
    0.98338511,
    0.983662419,
    0.983937413,
    0.984210092,
    0.984480455,
    0.984748502,
    0.985014231,
    0.985277642,
    0.985538735,
    0.985797509,
    0.986053963,
    0.986308097,
    0.98655991,
    0.986809402,
    0.987056571,
    0.987301418,
    0.987543942,
    0.987784142,
    0.988022017,
    0.988257568,
    0.988490793,
    0.988721692,
    0.988950265,
    0.98917651,
    0.989400428,
    0.989622017,
    0.989841278,
    0.99005821,
    0.990272812,
    0.990485084,
    0.990695025,
    0.990902635,
    0.991107914,
    0.99131086,
    0.991511473,
    0.991709754,
    0.9919057,
    0.992099313,
    0.992290591,
    0.992479535,
    0.992666142,
    0.992850414,
    0.99303235,
    0.993211949,
    0.993389211,
    0.993564136,
    0.993736722,
    0.99390697,
    0.994074879,
    0.994240449,
    0.99440368,
    0.994564571,
    0.994723121,
    0.994879331,
    0.995033199,
    0.995184727,
    0.995333912,
    0.995480755,
    0.995625256,
    0.995767414,
    0.995907229,
    0.996044701,
    0.996179829,
    0.996312612,
    0.996443051,
    0.996571146,
    0.996696895,
    0.996820299,
    0.996941358,
    0.99706007,
    0.997176437,
    0.997290457,
    0.99740213,
    0.997511456,
    0.997618435,
    0.997723067,
    0.99782535,
    0.997925286,
    0.998022874,
    0.998118113,
    0.998211003,
    0.998301545,
    0.998389737,
    0.998475581,
    0.998559074,
    0.998640218,
    0.998719012,
    0.998795456,
    0.99886955,
    0.998941293,
    0.999010686,
    0.999077728,
    0.999142419,
    0.999204759,
    0.999264747,
    0.999322385,
    0.99937767,
    0.999430605,
    0.999481187,
    0.999529418,
    0.999575296,
    0.999618822,
    0.999659997,
    0.999698819,
    0.999735288,
    0.999769405,
    0.99980117,
    0.999830582,
    0.999857641,
    0.999882347,
    0.999904701,
    0.999924702,
    0.99994235,
    0.999957645,
    0.999970586,
    0.999981175,
    0.999989411,
    0.999995294,
    0.999998823,
    1};

const float ftan[1025] =
{
    0,
    0.001533982,
    0.003067971,
    0.004601975,
    0.006136,
    0.007670054,
    0.009204144,
    0.010738278,
    0.012272462,
    0.013806704,
    0.015341011,
    0.01687539,
    0.018409849,
    0.019944394,
    0.021479033,
    0.023013773,
    0.024548622,
    0.026083586,
    0.027618673,
    0.02915389,
    0.030689244,
    0.032224743,
    0.033760394,
    0.035296204,
    0.03683218,
    0.03836833,
    0.039904661,
    0.041441179,
    0.042977894,
    0.04451481,
    0.046051937,
    0.047589281,
    0.049126849,
    0.050664649,
    0.052202688,
    0.053740973,
    0.055279513,
    0.056818313,
    0.058357381,
    0.059896725,
    0.061436352,
    0.062976269,
    0.064516483,
    0.066057003,
    0.067597834,
    0.069138985,
    0.070680464,
    0.072222276,
    0.07376443,
    0.075306933,
    0.076849793,
    0.078393016,
    0.079936611,
    0.081480584,
    0.083024944,
    0.084569696,
    0.08611485,
    0.087660412,
    0.089206389,
    0.09075279,
    0.092299621,
    0.09384689,
    0.095394605,
    0.096942773,
    0.098491402,
    0.100040498,
    0.10159007,
    0.103140125,
    0.104690671,
    0.106241715,
    0.107793264,
    0.109345326,
    0.11089791,
    0.112451021,
    0.114004669,
    0.11555886,
    0.117113602,
    0.118668903,
    0.12022477,
    0.121781211,
    0.123338234,
    0.124895846,
    0.126454055,
    0.128012869,
    0.129572295,
    0.131132341,
    0.132693015,
    0.134254324,
    0.135816276,
    0.13737888,
    0.138942142,
    0.140506071,
    0.142070674,
    0.143635959,
    0.145201934,
    0.146768607,
    0.148335985,
    0.149904077,
    0.15147289,
    0.153042432,
    0.154612712,
    0.156183736,
    0.157755514,
    0.159328052,
    0.16090136,
    0.162475444,
    0.164050313,
    0.165625975,
    0.167202437,
    0.168779709,
    0.170357797,
    0.171936711,
    0.173516457,
    0.175097045,
    0.176678482,
    0.178260776,
    0.179843936,
    0.18142797,
    0.183012886,
    0.184598692,
    0.186185396,
    0.187773007,
    0.189361533,
    0.190950982,
    0.192541362,
    0.194132682,
    0.19572495,
    0.197318175,
    0.198912364,
    0.200507526,
    0.20210367,
    0.203700804,
    0.205298937,
    0.206898076,
    0.208498231,
    0.210099409,
    0.21170162,
    0.213304872,
    0.214909174,
    0.216514533,
    0.21812096,
    0.219728461,
    0.221337047,
    0.222946726,
    0.224557505,
    0.226169395,
    0.227782404,
    0.22939654,
    0.231011813,
    0.232628231,
    0.234245803,
    0.235864538,
    0.237484445,
    0.239105532,
    0.240727809,
    0.242351284,
    0.243975968,
    0.245601867,
    0.247228992,
    0.248857352,
    0.250486956,
    0.252117812,
    0.25374993,
    0.25538332,
    0.257017989,
    0.258653948,
    0.260291206,
    0.261929772,
    0.263569655,
    0.265210865,
    0.26685341,
    0.268497301,
    0.270142547,
    0.271789157,
    0.27343714,
    0.275086506,
    0.276737265,
    0.278389426,
    0.280042999,
    0.281697993,
    0.283354418,
    0.285012284,
    0.286671599,
    0.288332375,
    0.289994621,
    0.291658346,
    0.293323561,
    0.294990274,
    0.296658497,
    0.298328239,
    0.29999951,
    0.301672319,
    0.303346678,
    0.305022596,
    0.306700082,
    0.308379148,
    0.310059803,
    0.311742058,
    0.313425922,
    0.315111407,
    0.316798521,
    0.318487276,
    0.320177682,
    0.321869749,
    0.323563488,
    0.32525891,
    0.326956023,
    0.32865484,
    0.330355371,
    0.332057627,
    0.333761617,
    0.335467353,
    0.337174845,
    0.338884105,
    0.340595143,
    0.342307969,
    0.344022595,
    0.345739032,
    0.347457291,
    0.349177382,
    0.350899317,
    0.352623106,
    0.354348762,
    0.356076294,
    0.357805715,
    0.359537035,
    0.361270266,
    0.363005419,
    0.364742505,
    0.366481537,
    0.368222525,
    0.369965481,
    0.371710416,
    0.373457342,
    0.375206271,
    0.376957214,
    0.378710184,
    0.380465191,
    0.382222248,
    0.383981367,
    0.385742559,
    0.387505837,
    0.389271212,
    0.391038697,
    0.392808304,
    0.394580044,
    0.396353931,
    0.398129975,
    0.399908191,
    0.40168859,
    0.403471184,
    0.405255986,
    0.407043008,
    0.408832264,
    0.410623765,
    0.412417524,
    0.414213555,
    0.416011869,
    0.41781248,
    0.4196154,
    0.421420643,
    0.423228222,
    0.425038149,
    0.426850438,
    0.428665102,
    0.430482153,
    0.432301606,
    0.434123474,
    0.43594777,
    0.437774508,
    0.4396037,
    0.441435362,
    0.443269505,
    0.445106145,
    0.446945294,
    0.448786967,
    0.450631178,
    0.45247794,
    0.454327267,
    0.456179174,
    0.458033675,
    0.459890783,
    0.461750513,
    0.46361288,
    0.465477898,
    0.467345581,
    0.469215943,
    0.471089,
    0.472964767,
    0.474843257,
    0.476724485,
    0.478608467,
    0.480495218,
    0.482384751,
    0.484277084,
    0.486172229,
    0.488070204,
    0.489971023,
    0.491874701,
    0.493781254,
    0.495690698,
    0.497603048,
    0.499518319,
    0.501436528,
    0.50335769,
    0.505281821,
    0.507208937,
    0.509139054,
    0.511072189,
    0.513008357,
    0.514947575,
    0.516889858,
    0.518835225,
    0.52078369,
    0.522735271,
    0.524689984,
    0.526647846,
    0.528608875,
    0.530573086,
    0.532540497,
    0.534511125,
    0.536484988,
    0.538462101,
    0.540442484,
    0.542426153,
    0.544413126,
    0.54640342,
    0.548397054,
    0.550394044,
    0.55239441,
    0.554398168,
    0.556405338,
    0.558415937,
    0.560429983,
    0.562447495,
    0.564468492,
    0.566492991,
    0.568521012,
    0.570552574,
    0.572587694,
    0.574626393,
    0.576668689,
    0.578714602,
    0.58076415,
    0.582817353,
    0.584874231,
    0.586934803,
    0.588999089,
    0.591067108,
    0.593138881,
    0.595214427,
    0.597293767,
    0.599376921,
    0.601463909,
    0.603554752,
    0.605649469,
    0.607748083,
    0.609850613,
    0.611957081,
    0.614067507,
    0.616181913,
    0.61830032,
    0.620422749,
    0.622549222,
    0.62467976,
    0.626814385,
    0.628953119,
    0.631095985,
    0.633243003,
    0.635394196,
    0.637549587,
    0.639709198,
    0.641873051,
    0.64404117,
    0.646213577,
    0.648390295,
    0.650571348,
    0.652756758,
    0.654946549,
    0.657140745,
    0.659339369,
    0.661542445,
    0.663749996,
    0.665962048,
    0.668178623,
    0.670399748,
    0.672625445,
    0.67485574,
    0.677090657,
    0.679330222,
    0.681574459,
    0.683823394,
    0.686077052,
    0.688335459,
    0.69059864,
    0.692866621,
    0.695139429,
    0.697417088,
    0.699699627,
    0.70198707,
    0.704279445,
    0.706576779,
    0.708879098,
    0.711186429,
    0.713498801,
    0.71581624,
    0.718138773,
    0.72046643,
    0.722799237,
    0.725137223,
    0.727480415,
    0.729828844,
    0.732182537,
    0.734541523,
    0.73690583,
    0.73927549,
    0.741650529,
    0.744030979,
    0.746416869,
    0.748808229,
    0.751205089,
    0.75360748,
    0.756015431,
    0.758428973,
    0.760848139,
    0.763272957,
    0.765703461,
    0.768139681,
    0.770581649,
    0.773029396,
    0.775482956,
    0.77794236,
    0.780407641,
    0.782878832,
    0.785355965,
    0.787839074,
    0.790328192,
    0.792823353,
    0.79532459,
    0.797831938,
    0.800345431,
    0.802865102,
    0.805390988,
    0.807923123,
    0.810461542,
    0.813006281,
    0.815557374,
    0.818114859,
    0.820678771,
    0.823249147,
    0.825826023,
    0.828409436,
    0.830999423,
    0.833596021,
    0.836199269,
    0.838809204,
    0.841425864,
    0.844049287,
    0.846679513,
    0.84931658,
    0.851960527,
    0.854611393,
    0.85726922,
    0.859934046,
    0.862605911,
    0.865284857,
    0.867970924,
    0.870664153,
    0.873364586,
    0.876072264,
    0.87878723,
    0.881509526,
    0.884239193,
    0.886976276,
    0.889720817,
    0.89247286,
    0.895232449,
    0.897999627,
    0.900774439,
    0.903556931,
    0.906347146,
    0.909145131,
    0.911950931,
    0.914764592,
    0.91758616,
    0.920415683,
    0.923253207,
    0.92609878,
    0.92895245,
    0.931814263,
    0.93468427,
    0.937562519,
    0.940449058,
    0.943343938,
    0.946247209,
    0.94915892,
    0.952079122,
    0.955007866,
    0.957945204,
    0.960891188,
    0.963845869,
    0.9668093,
    0.969781534,
    0.972762624,
    0.975752624,
    0.978751589,
    0.981759572,
    0.984776629,
    0.987802815,
    0.990838186,
    0.993882798,
    0.996936708,
    0.999999973,
    1.00307265,
    1.006154798,
    1.009246475,
    1.012347739,
    1.01545865,
    1.018579268,
    1.021709653,
    1.024849866,
    1.027999968,
    1.031160021,
    1.034330086,
    1.037510227,
    1.040700507,
    1.043900989,
    1.047111738,
    1.050332817,
    1.053564293,
    1.056806231,
    1.060058697,
    1.063321758,
    1.066595482,
    1.069879935,
    1.073175187,
    1.076481306,
    1.079798362,
    1.083126425,
    1.086465566,
    1.089815855,
    1.093177365,
    1.096550168,
    1.099934336,
    1.103329944,
    1.106737066,
    1.110155775,
    1.113586149,
    1.117028262,
    1.120482192,
    1.123948015,
    1.12742581,
    1.130915655,
    1.134417629,
    1.137931813,
    1.141458287,
    1.144997132,
    1.14854843,
    1.152112264,
    1.155688717,
    1.159277873,
    1.162879817,
    1.166494635,
    1.170122413,
    1.173763237,
    1.177417196,
    1.181084378,
    1.184764872,
    1.188458768,
    1.192166158,
    1.195887132,
    1.199621783,
    1.203370205,
    1.207132491,
    1.210908736,
    1.214699036,
    1.218503488,
    1.222322189,
    1.226155237,
    1.230002731,
    1.233864771,
    1.237741459,
    1.241632896,
    1.245539185,
    1.249460429,
    1.253396734,
    1.257348204,
    1.261314946,
    1.265297068,
    1.269294679,
    1.273307887,
    1.277336803,
    1.281381539,
    1.285442207,
    1.289518921,
    1.293611795,
    1.297720944,
    1.301846487,
    1.30598854,
    1.310147222,
    1.314322654,
    1.318514956,
    1.322724251,
    1.326950662,
    1.331194315,
    1.335455334,
    1.339733847,
    1.344029982,
    1.348343869,
    1.352675637,
    1.35702542,
    1.36139335,
    1.365779561,
    1.37018419,
    1.374607374,
    1.379049251,
    1.383509961,
    1.387989644,
    1.392488445,
    1.397006505,
    1.401543972,
    1.406100991,
    1.410677711,
    1.415274282,
    1.419890854,
    1.424527581,
    1.429184617,
    1.433862117,
    1.438560239,
    1.443279142,
    1.448018986,
    1.452779933,
    1.457562148,
    1.462365796,
    1.467191044,
    1.47203806,
    1.476907016,
    1.481798084,
    1.486711438,
    1.491647253,
    1.496605708,
    1.501586983,
    1.506591258,
    1.511618718,
    1.516669547,
    1.521743933,
    1.526842064,
    1.531964133,
    1.537110333,
    1.542280858,
    1.547475907,
    1.552695678,
    1.557940373,
    1.563210197,
    1.568505355,
    1.573826055,
    1.579172508,
    1.584544927,
    1.589943526,
    1.595368524,
    1.600820139,
    1.606298595,
    1.611804116,
    1.617336928,
    1.622897263,
    1.628485351,
    1.634101428,
    1.639745731,
    1.645418501,
    1.651119979,
    1.656850413,
    1.662610049,
    1.668399139,
    1.674217937,
    1.6800667,
    1.685945688,
    1.691855163,
    1.697795392,
    1.703766642,
    1.709769187,
    1.715803301,
    1.721869262,
    1.727967352,
    1.734097857,
    1.740261064,
    1.746457264,
    1.752686753,
    1.75894983,
    1.765246796,
    1.771577957,
    1.777943623,
    1.784344106,
    1.790779724,
    1.797250797,
    1.803757649,
    1.810300609,
    1.81688001,
    1.823496187,
    1.830149482,
    1.836840239,
    1.843568808,
    1.850335541,
    1.857140797,
    1.863984937,
    1.870868329,
    1.877791343,
    1.884754357,
    1.891757749,
    1.898801907,
    1.90588722,
    1.913014083,
    1.920182898,
    1.927394069,
    1.934648007,
    1.941945129,
    1.949285856,
    1.956670615,
    1.964099837,
    1.971573962,
    1.979093433,
    1.986658699,
    1.994270217,
    2.001928447,
    2.009633858,
    2.017386924,
    2.025188124,
    2.033037946,
    2.040936883,
    2.048885434,
    2.056884107,
    2.064933414,
    2.073033877,
    2.081186024,
    2.089390388,
    2.097647514,
    2.105957949,
    2.114322252,
    2.122740988,
    2.131214731,
    2.13974406,
    2.148329566,
    2.156971846,
    2.165671507,
    2.174429162,
    2.183245436,
    2.19212096,
    2.201056377,
    2.210052338,
    2.219109501,
    2.228228538,
    2.237410127,
    2.246654959,
    2.255963732,
    2.265337157,
    2.274775955,
    2.284280855,
    2.293852601,
    2.303491946,
    2.313199654,
    2.322976501,
    2.332823275,
    2.342740776,
    2.352729815,
    2.362791217,
    2.372925819,
    2.383134471,
    2.393418036,
    2.40377739,
    2.414213425,
    2.424727044,
    2.435319165,
    2.445990722,
    2.456742662,
    2.467575948,
    2.478491558,
    2.489490487,
    2.500573744,
    2.511742355,
    2.522997364,
    2.53433983,
    2.545770831,
    2.557291462,
    2.568902836,
    2.580606085,
    2.592402359,
    2.604292829,
    2.616278682,
    2.62836113,
    2.640541401,
    2.652820748,
    2.665200441,
    2.677681775,
    2.690266067,
    2.702954655,
    2.715748902,
    2.728650195,
    2.741659943,
    2.754779583,
    2.768010575,
    2.781354405,
    2.794812588,
    2.808386663,
    2.822078199,
    2.835888792,
    2.849820067,
    2.863873681,
    2.878051318,
    2.892354696,
    2.906785562,
    2.921345698,
    2.936036917,
    2.950861069,
    2.965820036,
    2.980915737,
    2.996150128,
    3.011525201,
    3.027042987,
    3.042705558,
    3.058515022,
    3.074473533,
    3.090583283,
    3.106846511,
    3.123265497,
    3.139842568,
    3.156580098,
    3.173480507,
    3.190546265,
    3.207779893,
    3.225183962,
    3.242761096,
    3.260513974,
    3.278445328,
    3.296557951,
    3.31485469,
    3.333338456,
    3.352012218,
    3.370879012,
    3.389941935,
    3.409204153,
    3.428668899,
    3.448339479,
    3.468219267,
    3.488311716,
    3.508620351,
    3.529148777,
    3.549900681,
    3.570879831,
    3.59209008,
    3.613535369,
    3.635219731,
    3.657147288,
    3.679322261,
    3.701748966,
    3.724431821,
    3.74737535,
    3.770584182,
    3.794063055,
    3.817816824,
    3.841850458,
    3.866169047,
    3.890777807,
    3.915682079,
    3.940887338,
    3.966399195,
    3.992223401,
    4.01836585,
    4.044832588,
    4.071629812,
    4.098763881,
    4.126241316,
    4.154068808,
    4.182253222,
    4.210801606,
    4.239721193,
    4.269019408,
    4.298703876,
    4.328782431,
    4.359263115,
    4.390154194,
    4.421464161,
    4.453201745,
    4.485375918,
    4.517995906,
    4.551071198,
    4.58461155,
    4.618627003,
    4.653127887,
    4.688124833,
    4.723628786,
    4.759651016,
    4.796203126,
    4.833297072,
    4.870945169,
    4.909160111,
    4.94795498,
    4.987343265,
    5.027338876,
    5.067956161,
    5.109209925,
    5.151115444,
    5.193688489,
    5.236945342,
    5.280902822,
    5.3255783,
    5.370989729,
    5.417155664,
    5.464095289,
    5.511828445,
    5.560375656,
    5.60975816,
    5.65999794,
    5.711117758,
    5.763141189,
    5.816092656,
    5.869997471,
    5.924881875,
    5.980773082,
    6.037699321,
    6.095689887,
    6.154775192,
    6.214986817,
    6.276357569,
    6.338921542,
    6.402714181,
    6.467772347,
    6.534134391,
    6.601840231,
    6.670931428,
    6.741451278,
    6.813444897,
    6.886959322,
    6.962043615,
    7.038748968,
    7.117128824,
    7.197239003,
    7.279137832,
    7.362886289,
    7.448548157,
    7.536190185,
    7.625882262,
    7.717697608,
    7.811712967,
    7.908008831,
    8.006669664,
    8.107784155,
    8.211445483,
    8.317751605,
    8.426805567,
    8.538715838,
    8.653596672,
    8.7715685,
    8.89275835,
    9.01730031,
    9.145336019,
    9.277015211,
    9.412496301,
    9.551947021,
    9.695545118,
    9.843479111,
    9.99594912,
    10.15316777,
    10.3153612,
    10.48277011,
    10.65565101,
    10.83427751,
    11.01894174,
    11.20995602,
    11.40765455,
    11.61239542,
    11.82456276,
    12.04456916,
    12.27285834,
    12.50990815,
    12.75623392,
    13.01239222,
    13.27898503,
    13.55666452,
    13.84613835,
    14.14817572,
    14.46361419,
    14.79336748,
    15.1384343,
    15.49990848,
    15.87899055,
    16.27700111,
    16.6953962,
    17.13578512,
    17.59995116,
    18.08987575,
    18.60776676,
    19.15609181,
    19.73761765,
    20.35545684,
    21.01312359,
    21.71460063,
    22.46442008,
    23.26776148,
    24.13057171,
    25.05971254,
    26.06314367,
    27.15015135,
    28.33163688,
    29.6204836,
    31.0320288,
    32.58467724,
    34.30070837,
    36.20735261,
    38.33824752,
    40.73544008,
    43.45218974,
    46.55697296,
    50.1393358,
    54.31867302,
    59.25779555,
    65.18463857,
    72.42844163,
    81.48306367,
    93.124568,
    108.646392,
    130.3767195,
    162.9719075,
    217.2967535,
    325.9454596,
    651.8867598,
    2000};
/*******************************************************************************
 *---------------------------—----—--函数实现------------------------------------
 ******************************************************************************/
void SinCos_Table(p_Ang_SinCos PV)
{
    switch (PV->table_Angle & U_0) //  0---4095的电角度控制分四段查询90
    {
    case U0_90: //
        PV->table_Sin = fSin[PV->table_Angle];
        PV->table_Cos = fSin[0x3FF - PV->table_Angle];
        break;

    case U90_180:
        PV->table_Sin = fSin[0x0800 - PV->table_Angle];
        PV->table_Cos = -fSin[PV->table_Angle - 0x3FF];
        break;

    case U180_270:
        PV->table_Sin = -fSin[PV->table_Angle - 0x0800];
        PV->table_Cos = -fSin[0x0c00 - PV->table_Angle];
        break;

    case U270_360:
        PV->table_Sin = -fSin[0x1000 - PV->table_Angle];
        PV->table_Cos = fSin[PV->table_Angle - 0x0c00];
        break;
    }
}

void Atan_Cale(p_IQAtan pV) // 90度计算，求取求反正弦函数
{
    int16_t i = 0;
    if (pV->Alpha == 0)
    {
        if (pV->Beta == 0)
            i = 0;
        else
            i = 1023;
    }
    else
    {
        pV->IQTan = Abs(pV->Beta) / Abs(pV->Alpha);

        if (ftan[i + 512] <= pV->IQTan)
            i += 512;
        if (ftan[i + 256] <= pV->IQTan)
            i += 256;
        if (ftan[i + 128] <= pV->IQTan)
            i += 128;
        if (ftan[i + 64] <= pV->IQTan)
            i += 64;
        if (ftan[i + 32] <= pV->IQTan)
            i += 32;
        if (ftan[i + 16] <= pV->IQTan)
            i += 16;
        if (ftan[i + 8] <= pV->IQTan)
            i += 8;
        if (ftan[i + 4] <= pV->IQTan)
            i += 4;
        if (ftan[i + 2] <= pV->IQTan)
            i += 2;
        if (ftan[i + 1] <= pV->IQTan)
            i += 1;
    }
    if (pV->Beta > 0)
    {
        if (pV->Alpha > 0)
            pV->IQAngle = i;
        else
            pV->IQAngle = 2048 - i;
    }
    else
    {
        if (pV->Alpha > 0)
            pV->IQAngle = 4096 - i;
        else
            pV->IQAngle = i + 2048;
    }
    pV->IQAngle = (pV->IQAngle & IQAngle_Range);
}

float Limit_Sat(float Uint, float U_max, float U_min) // 限制赋值函数
{
    float Uout;
    if (Uint <= U_min)
    {
        Uout = U_min;        
    }
    else if (Uint >= U_max)
    {
        Uout = U_max;        
    }
    else
    {
        Uout = Uint;        
    }
    return Uout;
}

void Grad_XieLv(p_GXieLv pV) // 斜率梯度计算 ，按照一定梯度值加加减减
{
    if (pV->XieLv_X < (pV->XieLv_Y - pV->XieLv_Grad)) // XieLv_Grad 减梯度值时候
    {
        pV->XieLv_Y = pV->XieLv_Y - pV->XieLv_Grad;
    }
    else if (pV->XieLv_X > (pV->XieLv_Y + pV->XieLv_Grad)) // 加梯度值时候
    {
        pV->XieLv_Y = pV->XieLv_Y + pV->XieLv_Grad;
    }
    else
    {
        pV->XieLv_Y = pV->XieLv_X;
    }
}

uint32_t IQSqrt(uint32_t M) // 整数开方函数，具体原理可以百度
{
    uint32_t N, i, tmp, ttp;
    if (M == 0)
        return 0;
    N = 0;

    tmp = (M >> 30);

    M <<= 2;
    if (tmp > 1)
    {
        N++;
        tmp -= N;
    }
    for (i = 15; i > 0; i--)
    {
        N <<= 1;

        tmp <<= 2;
        tmp += (M >> 30);

        ttp = N;
        ttp = (ttp << 1) + 1;

        M <<= 2;
        if (tmp >= ttp)
        {
            tmp -= ttp;
            N++;
        }
    }
    return N;
}

/*******************************************************************************
 *---------------------------—----—---结束--------------------------------------
 ******************************************************************************/